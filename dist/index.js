"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }var nt=Object.defineProperty;var xe=Object.getOwnPropertySymbols;var ot=Object.prototype.hasOwnProperty,it=Object.prototype.propertyIsEnumerable;var Ee=(e,t,r)=>t in e?nt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Te=(e,t)=>{for(var r in t||(t={}))ot.call(t,r)&&Ee(e,r,t[r]);if(xe)for(var r of xe(t))it.call(t,r)&&Ee(e,r,t[r]);return e};var _react = require('react'); var _react2 = _interopRequireDefault(_react);var st=e=>{let t=null;switch(e){case 0:t="Jan";break;case 1:t="Feb";break;case 2:t="Mar";break;case 3:t="Apr";break;case 4:t="May";break;case 5:t="Jun";break;case 6:t="Jul";break;case 7:t="Aug";break;case 8:t="Sep";break;case 9:t="Oct";break;case 10:t="Nov";break;case 11:t="Dec";break;default:t="Jan"}return t},ce=st;var at=e=>{let t=null;switch(e){case 0:t="Mon";break;case 1:t="Tue";break;case 2:t="Wed";break;case 3:t="Thu";break;case 4:t="Fri";break;case 5:t="Sat";break;case 6:t="Sun";break;default:t="Mon"}return t},le=at;var lt=({windowTime:e,tick:t,contentWidth:r,blockWidth:n})=>{let{dayBlocks:o,hourBlocks:i}=_react.useMemo.call(void 0, ()=>{let s=e[0],a=[],f=[];if(t===null||r===null)return{dayBlocks:[],hourBlocks:[]};let l=r,u=1;for(;;){let d=new Date(s*1e3),g=new Date(d.getFullYear(),d.getMonth(),d.getDate(),23,59,59),m=(g.getTime()-d.getTime())/1e3/t;if(l-=m,Math.round(l)<0){let p=Math.round((m+l)/n);for(let b=0;b<p;b++)f.push(_react2.default.createElement("div",{className:"hour-block",key:`${d.getDate()}_hour_${b}`},b<10?`0${b}:00`:`${b}:00`));a.push(_react2.default.createElement("div",{className:"day-block",key:`${d.getDate()} ${d.getMonth()}`,style:{gridColumn:`${u} / ${u+p}`}},le(d.getDay())," ",d.getDate()," ",ce(d.getMonth()))),u+=p;break}let h=Math.round(m/n);for(let p=24-h;p<24;p++)f.push(_react2.default.createElement("div",{className:"hour-block",key:`${d.getDate()}_hour_${p}`},p<10?`0${p}:00`:`${p}:00`));if(a.push(_react2.default.createElement("div",{className:"day-block",key:`${d.getDate()} ${d.getMonth()}`,style:{gridColumn:`${u} / ${u+h}`}},le(d.getDay())," ",d.getDate()," ",ce(d.getMonth()))),u+=h,Math.round(l)===0)break;s=(g.getTime()+1e3)/1e3}return{dayBlocks:a,hourBlocks:f}},[t,e,r]);return{dayBlocks:o,hourBlocks:i}},De=lt;var ft=({windowTime:e,contentWidth:t})=>{let r=_react.useMemo.call(void 0, ()=>(e[1]-e[0])/3600,[e]),n=t?t/r:0;return{numberOfHourBlocks:r,blockWidth:n}},V=ft;var pt=({windowTime:e,tick:t,contentWidth:r,scrollWidth:n,additionalClassNames:o})=>{let i=_react.useRef.call(void 0, null),{blockWidth:s}=V({windowTime:e,contentWidth:r}),{dayBlocks:a,hourBlocks:f}=De({windowTime:e,tick:t,contentWidth:r,blockWidth:s}),l=o!=null&&o.timeBar?"time-bar "+o.timeBar:"time-bar",u=o!=null&&o.dayRow?"day-row "+o.dayRow:"day-row",d=o!=null&&o.hourRow?"hour-row "+o.hourRow:"hour-row";return _react2.default.createElement("div",{className:l},_react2.default.createElement("div",{className:"empty-block"}),_react2.default.createElement("div",{className:"time-content",ref:i,style:{minWidth:r||0}},_react2.default.createElement("div",{className:u,style:{gridTemplateColumns:`repeat(auto-fill, minmax(${s}px, 1fr))`}},a.map(g=>g)),_react2.default.createElement("div",{className:d,style:{gridTemplateColumns:`repeat(auto-fill, minmax(${s}px, 1fr))`}},f.map(g=>g))),n?_react2.default.createElement("div",{style:{width:n,height:"100%",boxSizing:"border-box",borderLeft:"1px solid yellow"}}):null)},Re=pt;var P=_react.createContext.call(void 0, null);var yt=({name:e,id:t})=>{let r=_react.useContext.call(void 0, P),n=r&&r.rowsHeight&&r.rowsHeight[t]?r.rowsHeight[t].minHeight:40;return _react2.default.createElement("div",{className:"row-header",style:{minHeight:n}},e)},Se=yt;var bt=({rows:e,className:t})=>{let r=t?"rows-header-wrapper "+t:"rows-header-wrapper";return _react2.default.createElement("div",{className:r},e.map(n=>_react2.default.createElement(Se,{key:`row_header_${n.id}`,id:n.id,name:n.name})))},Me=bt;var _t=({contentWidth:e,cellWidth:t,lineClassName:r})=>{let n=_react.useMemo.call(void 0, ()=>{let i=[],s=r?"line "+r:"line";if(e)for(let a=t;a<e;a=a+t)i.push(_react2.default.createElement("div",{key:`line_${a}`,className:s}));return i},[t,e]),o=_react.useMemo.call(void 0, ()=>e?e-n.length*t:0,[e,t,n]);return _react2.default.createElement("div",{className:o<1?"lines-canvas hide-last-line":"lines-canvas",style:o<1?{gridTemplateColumns:`repeat(auto-fill, minmax(${t}px, 1fr))`}:{gridTemplateColumns:`repeat(auto-fill, minmax(${o}px, ${t}px))`}},n)},He=_t;var vt=({id:e,startPosition:t,width:r,top:n,height:o})=>_react2.default.createElement("div",{id:`static_event_${e}`,key:`static_event_${e}`,className:"static-event",onDrop:i=>i.stopPropagation(),style:{left:t,width:r,top:n,minHeight:o}}),Oe=vt;var Le=Symbol.for("immer-nothing"),ze=Symbol.for("immer-draftable"),E=Symbol.for("immer-state"),xt=process.env.NODE_ENV!=="production"?[function(e){return`The plugin for '${e}' has not been loaded into Immer. To enable the plugin, import and call \`enable${e}()\` when initializing your application.`},function(e){return`produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '${e}'`},"This object has been frozen and should not be mutated",function(e){return"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+e},"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.","Immer forbids circular references","The first or second argument to `produce` must be a function","The third argument to `produce` must be a function or undefined","First argument to `createDraft` must be a plain object, an array, or an immerable object","First argument to `finishDraft` must be a draft returned by `createDraft`",function(e){return`'current' expects a draft, got: ${e}`},"Object.defineProperty() cannot be used on an Immer draft","Object.setPrototypeOf() cannot be used on an Immer draft","Immer only supports deleting array indices","Immer only supports setting array indices and the 'length' property",function(e){return`'original' expects a draft, got: ${e}`}]:[];function v(e,...t){if(process.env.NODE_ENV!=="production"){let r=xt[e],n=typeof r=="function"?r.apply(null,t):r;throw new Error(`[Immer] ${n}`)}throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var F=Object.getPrototypeOf;function B(e){return!!e&&!!e[E]}function $(e){var t;return e?Fe(e)||Array.isArray(e)||!!e[ze]||!!((t=e.constructor)!=null&&t[ze])||te(e)||re(e):!1}var Et=Object.prototype.constructor.toString();function Fe(e){if(!e||typeof e!="object")return!1;let t=F(e);if(t===null)return!0;let r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===Et}function q(e,t){ee(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function ee(e){let t=e[E];return t?t.type_:Array.isArray(e)?1:te(e)?2:re(e)?3:0}function de(e,t){return ee(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Be(e,t,r){let n=ee(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function Tt(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function te(e){return e instanceof Map}function re(e){return e instanceof Set}function N(e){return e.copy_||e.base_}function pe(e,t){if(te(e))return new Map(e);if(re(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);let r=Fe(e);if(t===!0||t==="class_only"&&!r){let n=Object.getOwnPropertyDescriptors(e);delete n[E];let o=Reflect.ownKeys(n);for(let i=0;i<o.length;i++){let s=o[i],a=n[s];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(n[s]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[s]})}return Object.create(F(e),n)}else{let n=F(e);if(n!==null&&r)return Te({},e);let o=Object.create(n);return Object.assign(o,e)}}function be(e,t=!1){return ne(e)||B(e)||!$(e)||(ee(e)>1&&(e.set=e.add=e.clear=e.delete=Dt),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>be(n,!0))),e}function Dt(){v(2)}function ne(e){return Object.isFrozen(e)}var Rt={};function I(e){let t=Rt[e];return t||v(0,e),t}var U;function We(){return U}function St(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Ae(e,t){t&&(I("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function me(e){he(e),e.drafts_.forEach(Pt),e.drafts_=null}function he(e){e===U&&(U=e.parent_)}function Ne(e){return U=St(U,e)}function Pt(e){let t=e[E];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function $e(e,t){t.unfinalizedDrafts_=t.drafts_.length;let r=t.drafts_[0];return e!==void 0&&e!==r?(r[E].modified_&&(me(t),v(4)),$(e)&&(e=Q(t,e),t.parent_||Z(t,e)),t.patches_&&I("Patches").generateReplacementPatches_(r[E].base_,e,t.patches_,t.inversePatches_)):e=Q(t,r,[]),me(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Le?e:void 0}function Q(e,t,r){if(ne(t))return t;let n=t[E];if(!n)return q(t,(o,i)=>Ie(e,n,t,o,i,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return Z(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;let o=n.copy_,i=o,s=!1;n.type_===3&&(i=new Set(o),o.clear(),s=!0),q(i,(a,f)=>Ie(e,n,o,a,f,r,s)),Z(e,o,!1),r&&e.patches_&&I("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function Ie(e,t,r,n,o,i,s){if(process.env.NODE_ENV!=="production"&&o===r&&v(5),B(o)){let a=i&&t&&t.type_!==3&&!de(t.assigned_,n)?i.concat(n):void 0,f=Q(e,o,a);if(Be(r,n,f),B(f))e.canAutoFreeze_=!1;else return}else s&&r.add(o);if($(o)&&!ne(o)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;Q(e,o),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&Z(e,o)}}function Z(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&be(t,r)}function Mt(e,t){let r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:We(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1},o=n,i=_e;r&&(o=[n],i=X);let{revoke:s,proxy:a}=Proxy.revocable(o,i);return n.draft_=a,n.revoke_=s,a}var _e={get(e,t){if(t===E)return e;let r=N(e);if(!de(r,t))return kt(e,r,t);let n=r[t];return e.finalized_||!$(n)?n:n===ue(e.base_,t)?(fe(e),e.copy_[t]=ye(n,e)):n},has(e,t){return t in N(e)},ownKeys(e){return Reflect.ownKeys(N(e))},set(e,t,r){let n=Ge(N(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){let o=ue(N(e),t),i=o==null?void 0:o[E];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(Tt(r,o)&&(r!==void 0||de(e.base_,t)))return!0;fe(e),ge(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return ue(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,fe(e),ge(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){let r=N(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){v(11)},getPrototypeOf(e){return F(e.base_)},setPrototypeOf(){v(12)}},X={};q(_e,(e,t)=>{X[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});X.deleteProperty=function(e,t){return process.env.NODE_ENV!=="production"&&isNaN(parseInt(t))&&v(13),X.set.call(this,e,t,void 0)};X.set=function(e,t,r){return process.env.NODE_ENV!=="production"&&t!=="length"&&isNaN(parseInt(t))&&v(14),_e.set.call(this,e[0],t,r,e[0])};function ue(e,t){let r=e[E];return(r?N(r):e)[t]}function kt(e,t,r){var o;let n=Ge(t,r);return n?"value"in n?n.value:(o=n.get)==null?void 0:o.call(e.draft_):void 0}function Ge(e,t){if(!(t in e))return;let r=F(e);for(;r;){let n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=F(r)}}function ge(e){e.modified_||(e.modified_=!0,e.parent_&&ge(e.parent_))}function fe(e){e.copy_||(e.copy_=pe(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Ct=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){let i=r;r=t;let s=this;return function(f=i,...l){return s.produce(f,u=>r.call(this,u,...l))}}typeof r!="function"&&v(6),n!==void 0&&typeof n!="function"&&v(7);let o;if($(t)){let i=Ne(this),s=ye(t,void 0),a=!0;try{o=r(s),a=!1}finally{a?me(i):he(i)}return Ae(i,n),$e(o,i)}else if(!t||typeof t!="object"){if(o=r(t),o===void 0&&(o=t),o===Le&&(o=void 0),this.autoFreeze_&&be(o,!0),n){let i=[],s=[];I("Patches").generateReplacementPatches_(t,o,i,s),n(i,s)}return o}else v(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(s,...a)=>this.produceWithPatches(s,f=>t(f,...a));let n,o;return[this.produce(t,r,(s,a)=>{n=s,o=a}),n,o]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){$(e)||v(8),B(e)&&(e=Ht(e));let t=Ne(this),r=ye(e,void 0);return r[E].isManual_=!0,he(t),r}finishDraft(e,t){let r=e&&e[E];(!r||!r.isManual_)&&v(9);let{scope_:n}=r;return Ae(n,t),$e(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){let o=t[r];if(o.path.length===0&&o.op==="replace"){e=o.value;break}}r>-1&&(t=t.slice(r+1));let n=I("Patches").applyPatches_;return B(e)?n(e,t):this.produce(e,o=>n(o,t))}};function ye(e,t){let r=te(e)?I("MapSet").proxyMap_(e,t):re(e)?I("MapSet").proxySet_(e,t):Mt(e,t);return(t?t.scope_:We()).drafts_.push(r),r}function Ht(e){return B(e)||v(10,e),Je(e)}function Je(e){if(!$(e)||ne(e))return e;let t=e[E],r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=pe(e,t.scope_.immer_.useStrictShallowCopy_)}else r=pe(e,!0);return q(r,(n,o)=>{Be(r,n,Je(o))}),t&&(t.finalized_=!1),r}var T=new Ct,Ue=T.produce,Lr=T.produceWithPatches.bind(T),Fr=T.setAutoFreeze.bind(T),Br=T.setUseStrictShallowCopy.bind(T),Wr=T.applyPatches.bind(T),Gr=T.createDraft.bind(T),Jr=T.finishDraft.bind(T);var W=_react.createContext.call(void 0, {dragStarted:!1,setDragStarted:()=>{}});var oe=_react.createContext.call(void 0, {});var At=(e,t)=>e.startTime-t.startTime<0||e.startTime===t.startTime&&e.endTime<t.endTime?-1:1,ie=At;var Lt=_react.forwardRef.call(void 0, (e,t)=>{let{setEvents:r,tick:n,id:o,windowTime:i,cellWidth:s,children:a}=e,{dragStarted:f,setDragStarted:l}=_react.useContext.call(void 0, W),{onDrop:u}=_react.useContext.call(void 0, oe),d=_react.useCallback.call(void 0, m=>{m.preventDefault();let h=m.target,{left:p}=h.getBoundingClientRect(),b=m.dataTransfer.getData("eventId"),w=Math.round((m.clientX-p)/s),R=s*w;r(Ue(k=>{let c=k.find(x=>x.id===b);if(c&&n){let x=i[0]+R*n,C=c.endTime-c.startTime,D=i[0]+C+R*n;u&&u({eventId:c.id,oldRowId:c.rowId,newRowId:e.id,startTime:x,endTime:D}),c.startTime=x,c.endTime=D,c.rowId=e.id}k.sort(ie)})),l(!1)},[r,n,i,s]),g=_react.useContext.call(void 0, P),y=g&&g.rowsHeight&&g.rowsHeight[o]?g.rowsHeight[o].minHeight:40;return _react2.default.createElement("div",{id:`row_${o}`,ref:t,onDragOver:m=>m.preventDefault(),onDrop:d,className:f?"row-content not-clickable":"row-content","data-index":o,style:{minHeight:y}},a)}),Xe=Lt;var Bt=({id:e,startPosition:t,width:r,top:n,props:o})=>{let{setDragStarted:i}=_react.useContext.call(void 0, W),s=_react.useCallback.call(void 0, l=>{l.stopPropagation(),l.dataTransfer.setData("eventId",e),setTimeout(()=>i(!0),0);let u=l.target;u.style.opacity="50%"},[i]),a=_react.useCallback.call(void 0, l=>{l.stopPropagation(),i(!1);let u=l.target;u.style.opacity="100%"},[i]),f=o!=null&&o.classNames?"event "+o.classNames.join(" "):"event";return _react2.default.createElement("div",{id:`event_${e}`,key:`event_${e}`,className:f,draggable:!(o!=null&&o.isLocked),onDragStart:s,onDragEnd:a,onMouseDown:l=>l.stopPropagation(),onMouseMove:l=>l.stopPropagation(),onDrop:l=>l.stopPropagation(),style:{left:t,width:r,top:n,cursor:o!=null&&o.isLocked?"not-allowed":"pointer"}},_react2.default.createElement("div",{className:"event-content"},o!=null&&o.content?o.content:null))},Ke=Bt;var Jt=({bodyRef:e,rowsContentRef:t})=>{let r=_react.useCallback.call(void 0, o=>{o.forEach(i=>{i.isIntersecting?i.target.classList.remove("row-hidden"):i.target.classList.add("row-hidden")})},[]),n=new IntersectionObserver(r,{root:e.current});_react.useEffect.call(void 0, ()=>(t.current&&t.current.forEach(o=>{n.observe(o)}),()=>n.disconnect()),[n])},Ve=Jt;var Yt=({rows:e,windowTime:t,tick:r,events:n,staticEvents:o,cellWidth:i,setEvents:s,bodyRef:a})=>{let f=_react.useContext.call(void 0, P),l=_react.useRef.call(void 0, null),u=_react.useRef.call(void 0, []),[d,g]=_react.useMemo.call(void 0, ()=>{let y=0;return[e.map((m,h)=>{let p=0,b=[],w=0,R=r?n.filter(c=>c.rowId===m.id).map(c=>{if(c.endTime>=t[0]&&c.startTime<=t[1]){let x=0,C=!0;for(let D=0;D<=p;D++)if(b&&b[D]&&b[D].endTime>c.startTime)x+=1;else{p>w&&(w=p),p=0,C=!1;break}return C&&(p=x),b[x]=c,_react2.default.createElement(Ke,{key:`event_${c.id}`,id:c.id,startPosition:(c.startTime-t[0])/r,width:(c.endTime-c.startTime)/r,top:10+22*x,props:c.props})}}):null;p>w&&(w=p),l.current===null?l.current={[m.id]:{minHeight:40+w*22}}:l.current[m.id]={minHeight:40+w*22},y+=40+w*22;let k=r&&o?o.filter(c=>c.rowId===m.id).map(c=>{if(c.endTime>=t[0]&&c.startTime<=t[1])return _react2.default.createElement(Oe,{key:`static_event_${c.id}`,id:c.id,startPosition:(c.startTime-t[0])/r,width:(c.endTime-c.startTime)/r,top:10,height:20+w*22})}):null;return _react2.default.createElement(_react2.default.Fragment,{key:`row_content_${m.id}`},_react2.default.createElement(Xe,{id:m.id,ref:c=>{u.current&&u.current[h]&&c?u.current[h]=c:u.current&&c&&u.current.push(c)},setEvents:s,tick:r,windowTime:t,cellWidth:i},R,k))}),y]},[e,n,r,t,i]);return Ve({rowsContentRef:u,bodyRef:a}),_react.useEffect.call(void 0, ()=>{f&&(f.setRowsHeight(l.current),f.setAllRowsHeight(g))},[d,g]),d},Qe=Yt;var Zt=_react.forwardRef.call(void 0, ({rows:e,events:t,staticEvents:r,setEvents:n,tick:o,windowTime:i,cellWidth:s,setWindowTime:a,contentWidth:f,setCellWidth:l,bodyRef:u,lineClassName:d},g)=>{let[y,m]=_react.useState.call(void 0, !1),h=_react.useRef.call(void 0, null),[p,b]=_react.useState.call(void 0, !1),{blockWidth:w}=V({windowTime:i,contentWidth:f}),R=_react.useContext.call(void 0, P),k=_react.useCallback.call(void 0, _=>{if(_.preventDefault(),!y)return;let S=_.target,{left:A}=S.getBoundingClientRect(),H=_.clientX-A,Y=o?Math.floor(o*w):0;h.current&&h.current-H>=w?(h.current=H,a(J=>[J[0]+Y,J[1]+Y])):h.current&&H-h.current>=w&&(h.current=H,a(J=>[J[0]-Y,J[1]-Y]))},[w,a,y]),c=_react.useCallback.call(void 0, _=>{m(!0),_.button===1&&_.preventDefault();let S=_.target,{left:A}=S.getBoundingClientRect();h.current=_.clientX-A},[m]),x=_react.useCallback.call(void 0, ()=>{m(!1)},[m]),C=_react.useCallback.call(void 0, ()=>m(!1),[m]),D=Qe({rows:e,windowTime:i,tick:o,events:t,staticEvents:r,cellWidth:s,setEvents:n,bodyRef:u}),ae=_react.useCallback.call(void 0, _=>{_.preventDefault(),_.button===1&&b(S=>!S)},[]),M=_react.useCallback.call(void 0, _=>{let S=o?900/o:0;p&&l(A=>{let H=_.deltaY>0?A+S:A-S;return H<S||H>S*12?A:H})},[p,s,o]);return _react.useEffect.call(void 0, ()=>{u.current&&(u.current.style.overflow=p?"hidden":"auto")},[p]),_react2.default.createElement("div",{key:"content",ref:g,className:"content-wrapper",onMouseDown:c,onMouseUp:x,onMouseMove:k,onMouseLeave:C,onAuxClick:ae,onWheel:M,style:{cursor:y?"grabbing":"grab",height:R==null?void 0:R.allRowsHeight}},_react2.default.createElement(He,{contentWidth:f,cellWidth:s,lineClassName:d}),D)}),tt=Zt;var nr=({windowTime:e,setTick:t,setCellWidth:r,contentRef:n})=>{let o=_react.useRef.call(void 0, 0),i=_react.useMemo.call(void 0, ()=>new ResizeObserver(s=>{var a;for(let f of s){let l=(a=f.borderBoxSize)==null?void 0:a[0].inlineSize;if(typeof l=="number"&&l!==o.current){o.current=l;let u=e[1]-e[0],d=u/3600;t(u/f.contentRect.width),r(f.contentRect.width/d)}}}),[e]);_react.useEffect.call(void 0, ()=>(n.current&&i.observe(n.current,{box:"border-box"}),()=>i.disconnect()),[i])},rt=nr;var Gn=({rows:e,events:t,staticEvents:r,onDrop:n,startDate:o,endDate:i,additionalClassNames:s})=>{let[a,f]=_react.useState.call(void 0, [new Date(o.getFullYear(),o.getMonth(),o.getDate(),o.getHours(),0,0).getTime()/1e3,new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),0,0).getTime()/1e3]),[l,u]=_react.useState.call(void 0, 0),[d,g]=_react.useState.call(void 0, []),y=_react.useRef.call(void 0, null),m=_react.useRef.call(void 0, null),h=_react.useRef.call(void 0, null),[p,b]=_react.useState.call(void 0, null),[w,R]=_react.useState.call(void 0, 0),[k,c]=_react.useState.call(void 0, null),[x,C]=_react.useState.call(void 0, 0);_react.useEffect.call(void 0, ()=>{if(y.current){let M=a[1]-a[0],_=M/3600;b(M/y.current.getBoundingClientRect().width),u(y.current.getBoundingClientRect().width/_)}},[]),_react.useEffect.call(void 0, ()=>{h.current&&R(h.current.getBoundingClientRect().width-h.current.scrollWidth)},[]),_react.useEffect.call(void 0, ()=>{g(t.sort(ie))},[t]);let[D,ae]=_react.useState.call(void 0, !1);return _react.useEffect.call(void 0, ()=>{let M=null;e.forEach(_=>{M===null?M={[_.id]:{minHeight:40}}:M[_.id]={minHeight:40}}),c(M)},[e]),rt({contentRef:y,setCellWidth:u,setTick:b,windowTime:a}),_react2.default.createElement("div",{className:"main-wrapper",ref:m},_react2.default.createElement(Re,{windowTime:a,tick:p,contentWidth:y.current?y.current.getBoundingClientRect().width:null,scrollWidth:w}),_react2.default.createElement("div",{className:"body-wrapper",ref:h},_react2.default.createElement(P.Provider,{value:{rowsHeight:k,setRowsHeight:c,allRowsHeight:x,setAllRowsHeight:C}},_react2.default.createElement(Me,{rows:e,className:s==null?void 0:s.rowsHeader}),_react2.default.createElement(W.Provider,{value:{dragStarted:D,setDragStarted:ae}},_react2.default.createElement(oe.Provider,{value:{onDrop:n}},_react2.default.createElement(tt,{events:d,staticEvents:r,rows:e,setEvents:g,tick:p,windowTime:a,cellWidth:l,setWindowTime:f,ref:y,setCellWidth:u,contentWidth:y.current?y.current.getBoundingClientRect().width:null,bodyRef:h,lineClassName:s==null?void 0:s.gridLine}))))))};exports.Timeline = Gn;
//# sourceMappingURL=index.js.map